<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Segudab — Catálogo de productos</title>

  <style>
    :root {
      --color-bg-dark: #050505;
      --color-bg-light: #f5f5f5;
      --color-primary: #e00000;
      --color-primary-dark: #b30000;
      --color-accent: #f4c542;
      --color-text: #111111;
      --max-width: 1200px;
    }

    * { box-sizing: border-box; }
    html, body { margin:0; width:100%; overflow-x:hidden; }

    body {
      margin: 0;
      font-family: system-ui, sans-serif;
      background: var(--color-bg-light);
    }

    /* Top bar */
    .top-bar {
      background: #000;
      color: #fff;
      font-size: 13px;
      padding: 6px 16px;
      display: flex;
      justify-content: center;
      gap: 16px;
      flex-wrap: wrap;
      text-align: center;
    }
    .top-bar span{ white-space: nowrap; }

    /* Nav */
    header {
      background: #000;
      color: #fff;
      padding: 12px 30px;
      position: sticky;
      top: 0;
      z-index: 999;
      box-shadow: 0 2px 8px rgba(0,0,0,0.4);
    }

    .nav-inner {
      max-width: var(--max-width);
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      position: relative;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
      color: #fff;
      text-decoration: none;
      min-width: 0;
    }

    .logo-img {
      width: 48px;
      height: 48px;
      border-radius: 6px;
      background: url('logo.png') center/cover no-repeat;
      flex: 0 0 auto;
    }

    .logo-text {
      display: flex;
      flex-direction: column;
      font-size: 13px;
      text-transform: uppercase;
      line-height: 1.1;
      min-width: 0;
    }

    .logo-text strong {
      font-size: 20px;
      letter-spacing: 1px;
    }

    .logo-text span{
      opacity: .9;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      max-width: 360px;
    }

    nav {
      display: flex;
      gap: 20px;
      font-size: 14px;
      text-transform: uppercase;
      align-items: center;
    }

    .nav-link{
      color: #fff;
      padding-bottom: 3px;
      border-bottom: 2px solid transparent;
      transition: .2s;
      text-decoration: none;
      position: relative;
      display: inline-block;
      -webkit-tap-highlight-color: transparent;
    }

    .nav-link:hover {
      border-color: var(--color-primary);
      color: var(--color-accent);
    }

    .nav-cta {
      background: var(--color-primary);
      padding: 8px 16px;
      border-radius: 999px;
      font-weight: 600;
      border-bottom: none;
    }
    .nav-cta:hover { background: var(--color-primary-dark); color:#fff; }

    /* === DROPDOWN PRODUCTOS === */
    .nav-item { position: relative; }
    .nav-link .caret { font-size: 10px; margin-left: 4px; }

    .dropdown {
      position: absolute;
      top: 100%;
      left: 0;
      background: #000;
      min-width: 200px;
      padding: 10px 0;
      box-shadow: 0 8px 18px rgba(0,0,0,0.6);
      opacity: 0;
      pointer-events: none;
      transform: translateY(8px);
      transition: opacity .15s ease, transform .15s ease;
      z-index: 9999;
      border-top: 2px solid var(--color-accent);
    }

    .nav-item:hover .dropdown {
      opacity: 1;
      pointer-events: auto;
      transform: translateY(0);
    }

    .dropdown a {
      display: block;
      padding: 8px 18px;
      font-size: 13px;
      color: #fff;
      text-decoration: none;
      border-bottom: none;
      text-transform: uppercase;
      white-space: nowrap;
    }

    .dropdown a:hover {
      background: #111;
      color: var(--color-accent);
    }

    /* ✅ Mobile menu (igual al resto) */
    .mobile-toggle{
      display:none;
      border:none;
      background:rgba(255,255,255,0.06);
      color:#fff;
      font-size:22px;
      cursor:pointer;
      padding:10px 12px;
      border-radius:12px;
      flex: 0 0 auto;
      -webkit-tap-highlight-color: transparent;
    }
    .mobile-toggle:active{ background: rgba(255,255,255,0.12); }

    .nav-overlay{
      display:none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.55);
      z-index: 9998;
    }

    /* Hero */
    .hero {
      background: radial-gradient(circle at top left, #333 0, #000 45%, #111 100%);
      color: #fff;
      padding: 60px 20px;
    }

    .hero-inner {
      max-width: var(--max-width);
      margin: 0 auto;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 40px;
      align-items: center;
    }

    .hero-title {
      font-size: 40px;
      text-transform: uppercase;
      font-weight: 800;
    }

    .hero-subtitle {
      font-size: 18px;
      text-transform: uppercase;
      color: #ddd;
      margin-bottom: 12px;
    }

    .hero-text {
      color: #ddd;
      max-width: 480px;
      margin-bottom: 20px;
      font-size: 15px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      padding: 12px 24px;
      border-radius: 999px;
      text-transform: uppercase;
      font-weight: 600;
      cursor: pointer;
      transition: .15s;
      text-decoration: none;
      border: none;
      -webkit-tap-highlight-color: transparent;
    }

    .btn-primary {
      background: var(--color-primary);
      color: #fff;
      box-shadow: 0 6px 14px rgba(224,0,0,0.5);
    }

    .btn-primary:hover { background: var(--color-primary-dark); }
    .hero-buttons { margin-top: 12px; }

    /* Aviso */
    .notice-bar {
      background: var(--color-primary);
      color: #fff;
      padding: 10px;
      text-align: center;
      font-size: 13px;
      margin-bottom: 20px;
    }

    /* Section */
    .section { padding: 50px 20px; }

    .section-inner {
      max-width: var(--max-width);
      margin: 0 auto;
      text-align: left;
    }

    .section-title {
      font-size: 26px;
      text-transform: uppercase;
      margin-bottom: 10px;
    }

    .section-subtitle {
      font-size: 14px;
      color: #777;
      margin-bottom: 10px;
    }

    /* --- CATÁLOGO & CARRITO --- */
    .catalog-layout {
      max-width: var(--max-width);
      margin: 0 auto;
      display: grid;
      grid-template-columns: minmax(0, 3fr) minmax(0, 1.3fr);
      gap: 24px;
      align-items: flex-start;
      padding: 0 10px;
      justify-content: center;
    }

    .product-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 20px;
    }

    .product-card {
      background: #fff;
      border-radius: 14px;
      overflow: hidden;
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
      display: flex;
      flex-direction: column;
      cursor: pointer;
    }

    .product-image {
      height: 170px;
      background-size: cover;
      background-position: center;
    }

    .product-image.product-image-contain {
      background-size: contain;
      background-position: top center;
      background-repeat: no-repeat;
      background-color: #fff;
    }

    .product-body { padding: 14px 16px 16px; text-align: left; }
    .product-name { font-size: 16px; font-weight: 700; margin-bottom: 6px; }
    .product-desc { font-size: 13px; color: #555; margin-bottom: 8px; }

    .product-tag {
      display: inline-block;
      font-size: 11px;
      text-transform: uppercase;
      background: #eee;
      padding: 2px 8px;
      border-radius: 999px;
      margin-bottom: 8px;
    }

    .product-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 6px;
    }

    .product-price { font-weight: 700; font-size: 15px; color: var(--color-primary); }

    .btn-small {
      padding: 8px 14px;
      font-size: 12px;
      border-radius: 999px;
      border: none;
      background: var(--color-primary);
      color: #fff;
      cursor: pointer;
      font-weight: 600;
    }

    .btn-small:hover { background: var(--color-primary-dark); }

    /* Sidebar */
    .sidebar {
      display: flex;
      flex-direction: column;
      gap: 16px;
      align-items: stretch;
    }

    /* FILTROS */
    .filters {
      background: #fff;
      padding: 16px 18px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
      text-align: left;
      width: 100%;
    }

    .filters h3 {
      margin: 0 0 10px;
      font-size: 16px;
      text-transform: uppercase;
    }

    .filter-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 10px;
    }

    .filter-btn {
      border-radius: 999px;
      border: 1px solid #ccc;
      background: #f7f7f7;
      padding: 6px 12px;
      font-size: 12px;
      cursor: pointer;
      text-transform: uppercase;
    }

    .filter-btn:hover { background: #eee; }

    .filter-btn.active {
      background: var(--color-primary);
      border-color: var(--color-primary);
      color: #fff;
    }

    .filters-row {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
      margin-top: 8px;
    }

    .filters-row label { font-size: 12px; color: #555; }

    .filters select,
    .filters input[type="text"] {
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 14px;
      width: 100%;
      max-width: 220px;
    }

    /* Carrito */
    .cart-panel {
      background: #fff;
      border-radius: 14px;
      padding: 16px 18px 18px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.12);
      position: sticky;
      top: 90px;
      font-size: 14px;
      max-width: 360px;
      width: 100%;
      justify-self: center;
      text-align: left;
      align-self: flex-start;
    }

    .cart-title { font-size: 18px; font-weight: 700; margin-bottom: 10px; }

    .cart-items {
      max-height: 220px;
      overflow-y: auto;
      margin-bottom: 10px;
      border-top: 1px solid #eee;
      border-bottom: 1px solid #eee;
      padding: 8px 0;
      font-size: 13px;
    }

    .cart-item { margin-bottom: 8px; padding-bottom: 6px; border-bottom: 1px dashed #eee; }
    .cart-item:last-child { border-bottom: none; }

    .cart-item-main {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 4px;
    }

    .cart-item-name { font-weight: 600; }

    .cart-item-subtotal { font-weight: 600; color: var(--color-primary); }

    .cart-item-meta { font-size: 12px; color: #555; margin-bottom: 4px; }

    .cart-item-actions { display: flex; align-items: center; gap: 6px; font-size: 12px; }

    .qty-btn, .remove-btn {
      border: none;
      border-radius: 999px;
      padding: 2px 7px;
      cursor: pointer;
      font-size: 12px;
      background: #eee;
    }

    .qty-btn:hover { background: #ddd; }

    .remove-btn {
      background: #f8d7da;
      color: #900;
      margin-left: auto;
    }

    .remove-btn:hover { background: #f1b0b7; }

    .cart-item-qty { min-width: 18px; text-align: center; font-weight: 600; }

    .cart-empty { color: #777; font-size: 13px; text-align: center; padding: 10px 0; }

    .cart-total {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 700;
      margin-bottom: 10px;
      margin-top: 4px;
    }

    .cart-note { font-size: 11px; color: #777; margin-bottom: 8px; }

    .payment-methods { font-size: 11px; color: #555; margin-bottom: 10px; }
    .payment-methods strong { font-size: 12px; display: block; margin-bottom: 4px; }
    .payment-methods ul { margin: 0; padding-left: 18px; }
    .payment-methods li { margin-bottom: 2px; }

    .checkout-inputs {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-bottom: 10px;
    }

    .checkout-inputs input {
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 13px;
      width: 100%;
    }

    .btn-cart {
      width: 100%;
      text-align: center;
      padding: 10px 14px;
      border-radius: 999px;
      border: none;
      background: var(--color-primary);
      color: #fff;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 4px;
    }

    .btn-cart:hover { background: var(--color-primary-dark); }

    .btn-mp { background: #009ee3; margin-top: 6px; }
    .btn-mp:hover { background: #007bb8; }

    /* === DETALLE DE PRODUCTO (overlay) === */
    .product-detail-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.75);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      padding: 20px;
    }

    .product-detail {
      background: #fff;
      border-radius: 18px;
      max-width: 880px;
      width: 100%;
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 1.4fr);
      gap: 24px;
      padding: 22px 24px 24px;
      position: relative;
    }

    .detail-image {
      border-radius: 14px;
      background-size: cover;
      background-position: center;
      min-height: 260px;
      cursor: zoom-in;
      position: relative;
    }

    .detail-image.detail-image-contain {
      background-size: contain;
      background-position: top center;
      background-repeat: no-repeat;
      background-color: #fff;
    }

    .gallery-arrow{
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      border: none;
      background: rgba(0,0,0,0.35);
      color:#fff;
      width: 34px;
      height: 34px;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      z-index: 2;
    }
    .gallery-arrow-left{ left: 10px; }
    .gallery-arrow-right{ right: 10px; }
    .gallery-arrow:hover{ background: rgba(0,0,0,0.55); }

    .detail-info { display: flex; flex-direction: column; gap: 10px; font-size: 14px; }

    .detail-tag {
      display: inline-block;
      font-size: 11px;
      text-transform: uppercase;
      padding: 2px 8px;
      border-radius: 999px;
      background: #eee;
      align-self: flex-start;
    }

    .detail-name { font-size: 20px; margin: 0; }
    .detail-article { margin: 0; font-size: 12px; color: #777; }
    .detail-desc { margin: 4px 0 0; color: #555; font-size: 14px; }
    .detail-stock { font-size: 13px; color: #008000; }

    .detail-price-row { margin-top: 8px; margin-bottom: 6px; }
    .detail-price { font-size: 20px; font-weight: 700; color: var(--color-primary); }

    .detail-form { display: flex; flex-wrap: wrap; gap: 12px; margin: 8px 0 4px; }
    .detail-form label { font-size: 13px; display: flex; flex-direction: column; gap: 4px; }

    .detail-form select,
    .detail-form input[type="number"] {
      padding: 6px 8px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 13px;
      min-width: 160px;
    }

    .detail-actions { margin-top: 4px; }

    .detail-add-btn {
      border: none;
      border-radius: 999px;
      padding: 10px 20px;
      background: var(--color-primary);
      color: #fff;
      font-weight: 600;
      font-size: 13px;
      cursor: pointer;
      text-transform: uppercase;
    }

    .detail-add-btn:hover { background: var(--color-primary-dark); }

    .detail-close {
      position: absolute;
      top: 10px;
      right: 12px;
      border: none;
      background: transparent;
      font-size: 20px;
      cursor: pointer;
      line-height: 1;
    }

    .detail-arrow {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      border: none;
      background: rgba(0,0,0,0.4);
      color: #fff;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      z-index: 3;
    }

    .detail-arrow-left { left: -18px; }
    .detail-arrow-right { right: -18px; }
    .detail-arrow:hover { background: rgba(0,0,0,0.6); }

    /* === ZOOM DE IMAGEN === */
    .image-zoom-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.85);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      padding: 20px;
      cursor: zoom-out;
    }

    .image-zoom-overlay img {
      max-width: 95vw;
      max-height: 95vh;
      object-fit: contain;
      display: block;
    }

    footer {
      padding: 22px 20px;
      text-align: center;
      font-size: 13px;
      color: #666;
    }

    /* ✅ Responsive (copiado del resto, sin tocar tu lógica de catálogo) */
    @media (max-width: 980px){
      header{ padding: 10px 14px; }

      .logo-img{ width:40px; height:40px; }
      .logo-text strong{ font-size:16px; }
      .logo-text span{ font-size:11px; max-width: 220px; }

      .mobile-toggle{ display:inline-flex; align-items:center; justify-content:center; }

      nav{
        position: fixed;
        top: 0;
        right: -92vw;
        width: 92vw;
        max-width: 420px;
        height: 100vh;
        background: #000;
        display: flex;
        flex-direction: column;
        gap: 0;
        padding: 14px 14px 22px;
        border-left: 1px solid rgba(255,255,255,0.10);
        z-index: 9999;
        transition: right .18s ease;
        overflow-y: auto;
      }

      header.nav-open .nav-overlay{ display:block; }
      header.nav-open nav{ right: 0; }

      nav a{
        padding: 14px 12px;
        border-bottom: 1px solid rgba(255,255,255,0.10);
        border-left: 3px solid transparent;
      }

      .nav-cta{
        margin-top: 12px;
        width:100%;
        text-align:center;
        padding: 12px 16px;
      }

      /* dropdown en mobile: por click */
      .nav-item:hover .dropdown{
        opacity: 0;
        pointer-events: none;
        transform: translateY(8px);
      }

      .dropdown{
        position: static;
        opacity: 1;
        pointer-events: auto;
        transform: none;
        box-shadow: none;
        border-top: none;
        padding: 0;
        margin: 0;
        display: none;
      }
      .nav-item.open .dropdown{ display:block; }

      .dropdown a{
        padding: 12px 12px 12px 22px;
        font-size: 13px;
        border-bottom: 1px solid rgba(255,255,255,0.10);
      }

      .top-bar{
        gap: 8px 14px;
        padding: 8px 10px;
        font-size: 12px;
      }
      .top-bar span{ white-space: normal; }

      .hero{ padding: 46px 14px 42px; }
      .hero-inner { grid-template-columns: 1fr; gap: 16px; }
      .hero-title{ font-size: 30px; line-height: 1.05; }
      .hero-subtitle{ font-size: 14px; margin-bottom: 12px; }
      .hero-text{ font-size: 14px; max-width: 100%; }
      .btn{ width: 100%; justify-content:center; }

      .section{ padding: 36px 14px; }
      .section-title{ font-size: 22px; }
      .section-subtitle{ margin-bottom: 12px; }

      .catalog-layout { grid-template-columns: 1fr; padding: 0; }
      .cart-panel { position: static; max-width: none; top:auto; }
      .sidebar { max-width: 520px; width: 100%; margin: 0 auto; }

      .product-detail { grid-template-columns: 1fr; }
      .detail-image { min-height: 200px; }
      .detail-arrow-left { left: 4px; }
      .detail-arrow-right { right: 4px; }
    }

    @media (max-width: 520px){
      .logo-text span{ display:none; }
      .hero-title{ font-size: 28px; }
      .hero-text{ font-size: 13px; }
      .section-title{ font-size: 20px; }
    }
  </style>
</head>

<body>

  <!-- TOP BAR -->
  <div class="top-bar">
    <span>WhatsApp 11 3728-6846</span>
    <span>Industria argentina • Venta mayorista y minorista</span>
  </div>

  <!-- HEADER -->
  <header id="site-header">
    <div class="nav-inner">
      <a href="index.html" class="logo">
        <div class="logo-img"></div>
        <div class="logo-text">
          <strong>SEGUDAB</strong>
          <span>Equipamiento táctico y policial</span>
        </div>
      </a>

      <!-- ✅ Botón mobile -->
      <button class="mobile-toggle" id="mobile-toggle" aria-label="Abrir menú" aria-expanded="false">☰</button>

      <!-- ✅ Overlay -->
      <div class="nav-overlay" id="nav-overlay" aria-hidden="true"></div>

      <nav id="main-nav" aria-label="Navegación principal">
        <a href="index.html" class="nav-link">Inicio</a>

        <div class="nav-item" id="nav-products">
          <a href="productos.html" class="nav-link" id="products-link">
            Productos <span class="caret">▼</span>
          </a>

          <div class="dropdown" id="products-dropdown">
            <a href="productos.html?cat=calzado">Calzado</a>
            <a href="productos.html?cat=correajes">Correajes</a>
            <a href="productos.html?cat=accesorios">Accesorios</a>
            <a href="productos.html?cat=indumentaria">Indumentaria</a>
          </div>
        </div>

        <a href="porque-elegirnos.html" class="nav-link">¿Por qué elegirnos?</a>
        <a href="contacto.html" class="nav-link nav-cta">Contactar</a>
      </nav>
    </div>
  </header>

  <!-- HERO -->
  <section class="hero">
    <div class="hero-inner">
      <div>
        <h1 class="hero-title">Catálogo de productos</h1>
        <p class="hero-subtitle">Botas, zapatos, correajes, accesorios e indumentaria</p>

        <p class="hero-text">
          Seleccioná los productos que necesitás y armá tu pedido. Luego podés enviarnos la consulta con el detalle
          para coordinar stock, formas de pago y retiro o envío.
        </p>

        <div class="hero-buttons">
          <a
            href="https://wa.me/5491137286846?text=Hola-Segudab,-quisiera-consultar-por-compras-mayoristas"
            class="btn btn-primary"
            target="_blank"
            rel="noopener"
          >
            Consulta mayorista
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- AVISO -->
  <div class="notice-bar">Insignias policiales se venden únicamente a personal de fuerzas con identificación.</div>

  <!-- SECCIÓN CATÁLOGO -->
  <section class="section">
    <div class="section-inner">
      <h2 class="section-title">Catálogo completo</h2>
      <p class="section-subtitle">
        Catálogo orientativo. Los precios pueden variar según talle, modelo y cantidad. Consultá para presupuesto final.
      </p>
      <p class="section-subtitle" id="product-count-text"></p>
    </div>

    <div class="catalog-layout">
      <!-- PRODUCTOS -->
      <div class="product-grid">

        <!-- (TODO tu listado de productos queda EXACTAMENTE igual) -->

        <!-- 1. CAMISA MANGA LARGA -->
        <div class="product-card"
             data-category="indumentaria"
             data-price="0"
             data-size-options="34,36,38,40,42,44,46,48,50,52,54,56,58,60"
             data-article="ART-CAM-ML">
          <div class="product-image product-image-contain"
               style="background-image:url('productos/Indumentaria/camisa-manga-larga.png');"></div>
          <div class="product-body">
            <div class="product-tag">Indumentaria</div>
            <div class="product-name">Camisa manga larga</div>
            <div class="product-desc">
              Camisa manga larga azul en ripstop, negra en batista.
              Talles: 34 al 60.
            </div>
            <div class="product-footer">
              <span class="product-price">Consultar</span>
              <button class="btn-small" type="button">Ver detalle</button>
            </div>
          </div>
        </div>

        <!-- ... (seguí pegando el resto de tus cards tal cual) ... -->

      </div><!-- /product-grid -->

      <!-- SIDEBAR: FILTROS + CARRITO -->
      <div class="sidebar">

        <!-- FILTROS -->
        <div class="filters">
          <h3>Filtrar productos</h3>

          <div class="filter-buttons">
            <button class="filter-btn active" data-category="all">Todos</button>

            <!-- CALZADO -->
            <button class="filter-btn" data-category="calzado">Calzado</button>
            <button class="filter-btn" data-category="zapatos">Zapatos</button>
            <button class="filter-btn" data-category="borcegos">Borcegos</button>
            <button class="filter-btn" data-category="botines">Botines</button>

            <!-- RESTO -->
            <button class="filter-btn" data-category="correajes">Correajes</button>
            <button class="filter-btn" data-category="accesorios">Accesorios</button>
            <button class="filter-btn" data-category="indumentaria">Indumentaria</button>
          </div>

          <div class="filters-row">
            <label for="filter-search">Buscar producto:</label>
            <input type="text" id="filter-search" placeholder="Buscar por nombre o descripción" />
          </div>

          <div class="filters-row">
            <label for="filter-price">Filtrar por precio:</label>
            <select id="filter-price">
              <option value="all">Todos los precios</option>
              <option value="low">Menos de $20.000</option>
              <option value="mid">Entre $20.000 y $40.000</option>
              <option value="high">Más de $40.000</option>
            </select>

            <button id="clear-filters" type="button" class="filter-btn">
              Limpiar filtros
            </button>
          </div>
        </div>

        <!-- CARRITO -->
        <aside class="cart-panel">
          <div class="cart-title">Carrito de compras (<span id="cart-count">0</span>)</div>

          <div id="cart-items" class="cart-items">
            <div class="cart-empty">Todavía no agregaste productos.</div>
          </div>

          <div class="cart-total">
            <span>Total estimado:</span>
            <span id="cart-total">$0</span>
          </div>

          <div class="cart-note">
            Este carrito es orientativo. Para confirmar precios, stock y medio de pago,
            completá tus datos y envianos el pedido.
          </div>

          <div class="payment-methods">
            <strong>Medios de pago:</strong>
            <ul>
              <li>Efectivo en el local</li>
              <li>Transferencia bancaria</li>
              <li>Tarjeta de crédito/débito y billeteras virtuales vía Mercado Pago</li>
            </ul>
          </div>

          <div class="cart-note" style="margin-top:8px; color:#900; font-weight:600;">
            ⚠️ Envíos al interior del país:<br>
            Se realizan únicamente por <strong>Vía Cargo</strong> y son a cargo del comprador.
            El costo de envío se abona al retirar la mercadería.
          </div>

          <div class="checkout-inputs">
            <input id="checkout-nombre" type="text" placeholder="Nombre y apellido" />
            <input id="checkout-telefono" type="text" placeholder="Teléfono" />
            <input id="checkout-email" type="email" placeholder="Correo (opcional)" />
          </div>

          <button class="btn-cart" type="button" onclick="finalizarCompraWhatsApp()">
            Enviar pedido por WhatsApp
          </button>

          <button class="btn-cart btn-mp" type="button" onclick="pagarConMercadoPago()">
            Pagar con Mercado Pago
          </button>
        </aside>
      </div><!-- /sidebar -->

    </div><!-- /catalog-layout -->
  </section>

  <!-- DETALLE DE PRODUCTO (OVERLAY) -->
  <div class="product-detail-overlay" id="product-detail-overlay">
    <div class="product-detail">
      <button class="detail-close" type="button" id="detail-close-btn">×</button>
      <button class="detail-arrow detail-arrow-left" type="button" id="detail-prev-btn">‹</button>
      <button class="detail-arrow detail-arrow-right" type="button" id="detail-next-btn">›</button>

      <div class="detail-image" id="detail-image">
        <button class="gallery-arrow gallery-arrow-left" type="button" id="gallery-prev-btn">‹</button>
        <button class="gallery-arrow gallery-arrow-right" type="button" id="gallery-next-btn">›</button>
      </div>

      <div class="detail-info">
        <div class="detail-tag" id="detail-tag"></div>
        <h3 class="detail-name" id="detail-name"></h3>
        <p class="detail-article" id="detail-article"></p>
        <p class="detail-desc" id="detail-desc"></p>
        <p class="detail-stock" id="detail-stock">Stock a confirmar según talle y cantidad.</p>

        <div class="detail-price-row">
          <span class="detail-price" id="detail-price"></span>
        </div>

        <div class="detail-form">
          <label>
            <span id="detail-size-label">Talle</span>
            <select id="detail-size"></select>
          </label>

          <label id="detail-talle-wrap" style="display:none;">
            Talle
            <select id="detail-talle"></select>
          </label>

          <label id="detail-color-wrap" style="display:none;">
            Color
            <select id="detail-color"></select>
          </label>

          <label>
            Cantidad
            <input type="number" id="detail-qty" min="1" value="1" />
          </label>
        </div>

        <div class="detail-actions">
          <button class="detail-add-btn" type="button" id="detail-add-btn">
            Agregar al carrito
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- OVERLAY PARA ZOOM DE IMAGEN -->
  <div class="image-zoom-overlay" id="image-zoom-overlay">
    <img id="zoom-image" alt="Vista ampliada del producto" />
  </div>

  <!-- FOOTER -->
  <footer>
    © 2025 Segudab — Todos los derechos reservados.
  </footer>

  <script>
    /* ✅ MENU MOBILE (igual a tu index) */
    const header = document.getElementById('site-header');
    const toggle = document.getElementById('mobile-toggle');
    const nav = document.getElementById('main-nav');
    const overlay = document.getElementById('nav-overlay');

    const productsItem = document.getElementById('nav-products');
    const productsLink = document.getElementById('products-link');

    function closeMenu(){
      header.classList.remove('nav-open');
      toggle.textContent = '☰';
      toggle.setAttribute('aria-expanded','false');
      overlay.setAttribute('aria-hidden','true');
      productsItem.classList.remove('open');
    }

    function openMenu(){
      header.classList.add('nav-open');
      toggle.textContent = '✕';
      toggle.setAttribute('aria-expanded','true');
      overlay.setAttribute('aria-hidden','false');
    }

    if (toggle) {
      toggle.addEventListener('click', () => {
        const isOpen = header.classList.contains('nav-open');
        isOpen ? closeMenu() : openMenu();
      });
    }

    if (overlay) overlay.addEventListener('click', closeMenu);

    if (nav) {
      nav.addEventListener('click', (e) => {
        const a = e.target.closest('a');
        if (!a) return;

        if (a === productsLink && window.matchMedia('(max-width: 980px)').matches) {
          e.preventDefault();
          productsItem.classList.toggle('open');
          return;
        }

        closeMenu();
      });
    }

    window.addEventListener('resize', () => {
      if (!window.matchMedia('(max-width: 980px)').matches) {
        closeMenu();
      }
    });

    /* ====== TU SCRIPT ORIGINAL DE CATALOGO (SIN CAMBIOS) ====== */
    const CART_KEY = 'segudab_cart';
    let cart = [];
    let currentProduct = null;

    const MP_LINK = 'https://mpago.la/tu_link_de_pago';

    let visibleProductCards = [];
    let currentProductIndex = -1;
    let searchTerm = '';

    let currentGallery = [];
    let galleryIndex = 0;

    function loadCart() {
      const stored = localStorage.getItem(CART_KEY);
      if (!stored) return;
      try {
        const parsed = JSON.parse(stored);
        if (Array.isArray(parsed)) cart = parsed;
      } catch (e) {
        console.error('Error leyendo carrito de localStorage', e);
      }
    }

    function saveCart() { localStorage.setItem(CART_KEY, JSON.stringify(cart)); }
    function formatPrice(value) { return Number(value).toLocaleString('es-AR'); }

    function renderCart() {
      const cartItemsContainer = document.getElementById('cart-items');
      const cartCount = document.getElementById('cart-count');
      const cartTotal = document.getElementById('cart-total');

      cartItemsContainer.innerHTML = '';

      if (cart.length === 0) {
        cartItemsContainer.innerHTML = '<div class="cart-empty">Todavía no agregaste productos.</div>';
        cartCount.textContent = '0';
        cartTotal.textContent = '$0';
        return;
      }

      let total = 0;
      let count = 0;

      cart.forEach(item => {
        total += item.price * item.qty;
        count += item.qty;

        const div = document.createElement('div');
        div.className = 'cart-item';
        div.innerHTML = `
          <div class="cart-item-main">
            <span class="cart-item-name">${item.name}</span>
            <span class="cart-item-subtotal">$${formatPrice(item.price * item.qty)}</span>
          </div>
          <div class="cart-item-meta">
            Variante: ${item.size || 'A coordinar'}
          </div>
          <div class="cart-item-actions">
            <button class="qty-btn" data-action="decrease" data-name="${item.name}" data-size="${item.size}">−</button>
            <span class="cart-item-qty">${item.qty}</span>
            <button class="qty-btn" data-action="increase" data-name="${item.name}" data-size="${item.size}">+</button>
            <button class="remove-btn" data-action="remove" data-name="${item.name}" data-size="${item.size}">✕</button>
          </div>
        `;
        cartItemsContainer.appendChild(div);
      });

      cartCount.textContent = count;
      cartTotal.textContent = '$' + formatPrice(total);
    }

    function addToCart(name, price, size = 'A coordinar', qty = 1) {
      const existing = cart.find(p => p.name === name && p.size === size);
      if (existing) existing.qty += qty;
      else cart.push({ name, price: Number(price), qty: qty, size });
      saveCart();
      renderCart();
    }

    function updateItemQty(name, size, delta) {
      const item = cart.find(p => p.name === name && p.size === size);
      if (!item) return;
      item.qty += delta;
      if (item.qty < 1) item.qty = 1;
      saveCart();
      renderCart();
    }

    function removeFromCart(name, size) {
      const index = cart.findIndex(p => p.name === name && p.size === size);
      if (index !== -1) {
        cart.splice(index, 1);
        saveCart();
        renderCart();
      }
    }

    const sizeOptionsByCategory = {
      botas: ['38','39','40','41','42','43','44','45'],
      correajes: ['S','M','L','XL'],
      accesorios: ['Único'],
      indumentaria: ['S','M','L','XL','XXL'],
      zapatos: ['38','39','40','41','42','43','44','45'],
      borcegos: ['38','39','40','41','42','43','44','45'],
      botines: ['38','39','40','41','42','43','44','45'],
    };

    function updateGalleryArrows() {
      const prev = document.getElementById('gallery-prev-btn');
      const next = document.getElementById('gallery-next-btn');
      const show = currentGallery && currentGallery.length > 1;

      if (prev) prev.style.display = show ? 'flex' : 'none';
      if (next) next.style.display = show ? 'flex' : 'none';
    }

    function setGalleryIndex(idx) {
      const detailImage = document.getElementById('detail-image');
      if (!currentGallery || !currentGallery.length) return;

      galleryIndex = (idx + currentGallery.length) % currentGallery.length;
      const url = currentGallery[galleryIndex];

      if (detailImage && url) {
        detailImage.style.backgroundImage = `url('${url}')`;
        if (currentProduct) currentProduct.imageUrl = url;
      }
    }

    function showNextGallery() { setGalleryIndex(galleryIndex + 1); }
    function showPrevGallery() { setGalleryIndex(galleryIndex - 1); }

    function openProductDetail(card) {
      const overlay = document.getElementById('product-detail-overlay');
      const nameEl = card.querySelector('.product-name');
      const descEl = card.querySelector('.product-desc');
      const tagEl  = card.querySelector('.product-tag');
      const imgEl  = card.querySelector('.product-image');

      const name = nameEl ? nameEl.textContent.trim() : '';
      const desc = descEl ? descEl.textContent.trim() : '';
      const tag  = tagEl ? tagEl.textContent.trim() : '';
      const cat  = card.dataset.category || '';
      const basePrice = Number(card.dataset.price || 0);
      const article = card.dataset.article || '';
      const stockTextFromCard = card.dataset.stock;

      let bg = imgEl ? imgEl.style.backgroundImage : '';
      let imageUrl = '';
      if (bg && bg.startsWith('url')) {
        imageUrl = bg.slice(4, -1).replace(/["']/g, '');
      }

      const modelOptionsRaw = card.dataset.modelOptions;
      const modelImagesRaw  = card.dataset.modelImages;
      const modelPricesRaw  = card.dataset.modelPrices;
      const modelColorsRaw  = card.dataset.modelColors;

      const modelOptions = modelOptionsRaw ? modelOptionsRaw.split('|').map(s => s.trim()).filter(Boolean) : null;
      const modelImages  = modelImagesRaw  ? modelImagesRaw.split('|').map(s => s.trim()).filter(Boolean) : null;
      const modelPrices  = modelPricesRaw  ? modelPricesRaw.split('|').map(s => Number(String(s).trim() || 0)) : null;
      const modelColors  = modelColorsRaw  ? modelColorsRaw.split('|').map(s => s.trim()) : null;

      const colorOptionsRaw = card.dataset.colorOptions;
      const colorOptions = colorOptionsRaw ? colorOptionsRaw.split('|').map(s => s.trim()).filter(Boolean) : null;

      function readColorBundle(colorName) {
        const key = (colorName || '').toLowerCase();
        const modelsRaw = card.dataset['colorModels' + key.charAt(0).toUpperCase() + key.slice(1)] || card.getAttribute('data-color-models-' + key);
        const pricesRaw = card.dataset['colorPrices' + key.charAt(0).toUpperCase() + key.slice(1)] || card.getAttribute('data-color-prices-' + key);
        const imagesRaw = card.dataset['colorImages' + key.charAt(0).toUpperCase() + key.slice(1)] || card.getAttribute('data-color-images-' + key);

        const models = modelsRaw ? String(modelsRaw).split('|').map(s => s.trim()).filter(Boolean) : [];
        const prices = pricesRaw ? String(pricesRaw).split('|').map(s => Number(String(s).trim() || 0)) : [];
        const images = imagesRaw ? String(imagesRaw).split('|').map(s => s.trim()).filter(Boolean) : [];
        return { models, prices, images };
      }

      currentProduct = {
        name,
        price: basePrice,
        category: cat,
        imageUrl,
        tag,
        desc,
        article,
        modelOptions,
        modelImages,
        modelPrices,
        modelColors,
        colorOptions,
        readColorBundle
      };

      if (!visibleProductCards.length) buildVisibleProductCards();
      currentProductIndex = visibleProductCards.indexOf(card);
      if (currentProductIndex === -1) {
        buildVisibleProductCards();
        currentProductIndex = visibleProductCards.indexOf(card);
      }

      const detailImage   = document.getElementById('detail-image');
      const detailTag     = document.getElementById('detail-tag');
      const detailName    = document.getElementById('detail-name');
      const detailDesc    = document.getElementById('detail-desc');
      const detailPrice   = document.getElementById('detail-price');
      const detailSize    = document.getElementById('detail-size');
      const detailQty     = document.getElementById('detail-qty');
      const detailArticle = document.getElementById('detail-article');
      const detailStock   = document.getElementById('detail-stock');
      const sizeLabelEl   = document.getElementById('detail-size-label');

      const colorWrap   = document.getElementById('detail-color-wrap');
      const colorSelect = document.getElementById('detail-color');

      const talleWrap   = document.getElementById('detail-talle-wrap');
      const talleSelect = document.getElementById('detail-talle');

      if (colorWrap) colorWrap.style.display = 'none';
      if (colorSelect) colorSelect.innerHTML = '';

      if (talleWrap) talleWrap.style.display = 'none';
      if (talleSelect) talleSelect.innerHTML = '';

      detailSize.innerHTML = '';

      currentGallery = imageUrl ? [imageUrl] : [];
      detailImage.style.backgroundImage = imageUrl ? `url('${imageUrl}')` : 'none';
      updateGalleryArrows();

      if (imgEl && imgEl.classList.contains('product-image-contain')) {
        detailImage.classList.add('detail-image-contain');
      } else {
        detailImage.classList.remove('detail-image-contain');
      }

      detailTag.textContent = tag;
      detailName.textContent = name;
      detailDesc.textContent = desc;

      if (detailStock) {
        detailStock.textContent = stockTextFromCard
          ? stockTextFromCard
          : 'Stock a confirmar según talle y cantidad.';
      }

      if (detailArticle) {
        if (article) {
          detailArticle.textContent = 'Artículo: ' + article;
          detailArticle.style.display = 'block';
        } else {
          detailArticle.style.display = 'none';
        }
      }

      function setDetailPrice(p) {
        const n = Number(p || 0);
        currentProduct.price = n;
        detailPrice.textContent = n > 0 ? ('$' + formatPrice(n)) : 'Consultar';
      }

      function setDetailImage(url) {
        if (!url) return;
        detailImage.style.backgroundImage = `url('${url}')`;
        currentProduct.imageUrl = url;
      }

      function fillTallesIfAny() {
        if (!talleWrap || !talleSelect) return;

        const customSizes = card.dataset.sizeOptions;
        if (!customSizes) {
          talleWrap.style.display = 'none';
          talleSelect.innerHTML = '';
          return;
        }

        const talles = customSizes.split(',').map(s => s.trim()).filter(Boolean);
        if (!talles.length) {
          talleWrap.style.display = 'none';
          talleSelect.innerHTML = '';
          return;
        }

        talleWrap.style.display = 'flex';
        talleWrap.style.flexDirection = 'column';
        talleSelect.innerHTML = '';

        talles.forEach(t => {
          const opt = document.createElement('option');
          opt.value = t;
          opt.textContent = t;
          talleSelect.appendChild(opt);
        });

        talleSelect.selectedIndex = 0;
      }

      if (colorSelect) colorSelect.onchange = null;
      detailSize.onchange = null;

      if (Array.isArray(currentProduct.colorOptions) && currentProduct.colorOptions.length) {
        if (sizeLabelEl) sizeLabelEl.textContent = 'Modelo';
        fillTallesIfAny();

        if (colorWrap) {
          colorWrap.style.display = 'flex';
          colorWrap.style.flexDirection = 'column';
        }

        colorSelect.innerHTML = '';
        currentProduct.colorOptions.forEach(c => {
          const opt = document.createElement('option');
          opt.value = c;
          opt.textContent = c;
          colorSelect.appendChild(opt);
        });

        function applySelectedModelFromSize() {
          const opt = detailSize.options[detailSize.selectedIndex];
          if (!opt) return;

          const img = opt.dataset.img || '';
          const prc = opt.dataset.price ? Number(opt.dataset.price) : 0;

          currentGallery = img ? [img] : [];
          galleryIndex = 0;
          if (currentGallery[0]) setDetailImage(currentGallery[0]);
          updateGalleryArrows();

          setDetailPrice(prc);
        }

        function fillModelsForColor(colorName) {
          const bundle = currentProduct.readColorBundle(colorName);

          detailSize.innerHTML = '';
          bundle.models.forEach((m, idx) => {
            const opt = document.createElement('option');
            opt.value = m;
            opt.textContent = m;
            opt.dataset.price = String(bundle.prices[idx] ?? 0);
            opt.dataset.img = bundle.images[idx] ?? '';
            detailSize.appendChild(opt);
          });

          if (!detailSize.options.length) {
            currentGallery = currentProduct.imageUrl ? [currentProduct.imageUrl] : [];
            galleryIndex = 0;
            if (currentGallery[0]) setDetailImage(currentGallery[0]);
            updateGalleryArrows();
            setDetailPrice(currentProduct.price);
            return;
          }

          detailSize.selectedIndex = 0;
          applySelectedModelFromSize();
        }

        fillModelsForColor(colorSelect.value);

        colorSelect.onchange = () => fillModelsForColor(colorSelect.value);
        detailSize.onchange  = () => applySelectedModelFromSize();
      }
      else if (Array.isArray(currentProduct.modelOptions) && currentProduct.modelOptions.length) {
        if (sizeLabelEl) sizeLabelEl.textContent = 'Modelo';
        fillTallesIfAny();

        currentProduct.modelOptions.forEach((m, idx) => {
          const opt = document.createElement('option');
          opt.value = m;
          opt.textContent = m;

          const prc = currentProduct.modelPrices && currentProduct.modelPrices[idx] != null
            ? Number(currentProduct.modelPrices[idx] || 0)
            : currentProduct.price;

          const img = currentProduct.modelImages && currentProduct.modelImages[idx]
            ? currentProduct.modelImages[idx]
            : currentProduct.imageUrl;

          opt.dataset.price = String(prc);
          opt.dataset.img = img || '';
          detailSize.appendChild(opt);
        });

        function setColorsForModel(modelIndex) {
          if (!colorWrap || !colorSelect) return;

          const colorsStr = currentProduct.modelColors && currentProduct.modelColors[modelIndex]
            ? currentProduct.modelColors[modelIndex]
            : '';

          const colors = String(colorsStr).split(',').map(c => c.trim()).filter(Boolean);

          if (colors.length <= 1) {
            colorWrap.style.display = 'none';
            colorSelect.innerHTML = '';
            if (colors[0]) {
              const o = document.createElement('option');
              o.value = colors[0];
              o.textContent = colors[0];
              colorSelect.appendChild(o);
            }
            return;
          }

          colorWrap.style.display = 'flex';
          colorWrap.style.flexDirection = 'column';
          colorSelect.innerHTML = '';
          colors.forEach(c => {
            const o = document.createElement('option');
            o.value = c;
            o.textContent = c;
            colorSelect.appendChild(o);
          });
        }

        function applySelectedModel() {
          const opt = detailSize.options[detailSize.selectedIndex];
          if (!opt) return;

          const img = opt.dataset.img || '';
          const prc = opt.dataset.price ? Number(opt.dataset.price) : 0;
          const model = (opt.value || '').trim().toLowerCase();

          if (model === 'arena' && card.dataset.galleryArena) {
            currentGallery = card.dataset.galleryArena.split('|').map(s => s.trim()).filter(Boolean);
          } else if (card.dataset.galleryDefault) {
            currentGallery = card.dataset.galleryDefault.split('|').map(s => s.trim()).filter(Boolean);
          } else {
            currentGallery = img ? [img] : [];
          }
          galleryIndex = 0;

          if (currentGallery[0]) setDetailImage(currentGallery[0]);
          updateGalleryArrows();

          setDetailPrice(prc);
          setColorsForModel(detailSize.selectedIndex);
        }

        applySelectedModel();
        detailSize.onchange = () => applySelectedModel();
      }
      else {
        if (sizeLabelEl) sizeLabelEl.textContent = 'Talle';
        if (talleWrap) talleWrap.style.display = 'none';
        if (talleSelect) talleSelect.innerHTML = '';

        const customSizes = card.dataset.sizeOptions;
        const options = customSizes
          ? customSizes.split(',').map(s => s.trim()).filter(Boolean)
          : (sizeOptionsByCategory[cat] || ['A coordinar']);

        options.forEach(talle => {
          const opt = document.createElement('option');
          opt.value = talle;
          opt.textContent = talle;
          detailSize.appendChild(opt);
        });

        currentGallery = imageUrl ? [imageUrl] : [];
        galleryIndex = 0;

        if (currentGallery[0]) setDetailImage(currentGallery[0]);
        updateGalleryArrows();

        setDetailPrice(currentProduct.price);
      }

      detailQty.value = 1;
      overlay.style.display = 'flex';
    }

    function closeProductDetail() {
      const overlay = document.getElementById('product-detail-overlay');
      overlay.style.display = 'none';
      currentProduct = null;
      currentProductIndex = -1;
      currentGallery = [];
      galleryIndex = 0;
      updateGalleryArrows();
    }

    function buildVisibleProductCards() {
      visibleProductCards = Array.from(document.querySelectorAll('.product-card'))
        .filter(card => card.style.display !== 'none');
    }

    function showNextProduct() {
      if (!visibleProductCards.length) buildVisibleProductCards();
      if (!visibleProductCards.length) return;

      if (currentProductIndex < 0) currentProductIndex = 0;

      let newIndex = currentProductIndex + 1;
      if (newIndex >= visibleProductCards.length) newIndex = 0;

      openProductDetail(visibleProductCards[newIndex]);
    }

    function showPrevProduct() {
      if (!visibleProductCards.length) buildVisibleProductCards();
      if (!visibleProductCards.length) return;

      if (currentProductIndex < 0) currentProductIndex = 0;

      let newIndex = currentProductIndex - 1;
      if (newIndex < 0) newIndex = visibleProductCards.length - 1;

      openProductDetail(visibleProductCards[newIndex]);
    }

    document.getElementById('cart-items').addEventListener('click', (e) => {
      const btn = e.target.closest('button');
      if (!btn) return;

      const action = btn.dataset.action;
      const name = btn.dataset.name;
      const size = btn.dataset.size;
      if (!action || !name) return;

      if (action === 'increase') updateItemQty(name, size, 1);
      else if (action === 'decrease') updateItemQty(name, size, -1);
      else if (action === 'remove') removeFromCart(name, size);
    });

    function finalizarCompraWhatsApp() {
      if (cart.length === 0) {
        alert('Primero agregá productos al carrito.');
        return;
      }

      const nombre = document.getElementById('checkout-nombre').value.trim();
      const telefono = document.getElementById('checkout-telefono').value.trim();
      const email = document.getElementById('checkout-email').value.trim();

      if (!nombre || !telefono) {
        alert('Por favor completá nombre y teléfono para enviar el pedido.');
        return;
      }

      let texto = 'Hola Segudab, quiero hacer un pedido desde la web:%0A%0A';
      texto += 'Nombre: ' + nombre + '%0A';
      texto += 'Teléfono: ' + telefono + '%0A';
      if (email) texto += 'Email: ' + email + '%0A';
      texto += '%0AProductos:%0A';

      let total = 0;
      cart.forEach(item => {
        total += item.price * item.qty;
        texto += '- ' + item.qty + ' x ' + item.name + ' (Variante: ' + (item.size || 'A coordinar') + ')%0A';
      });

      texto += '%0ATotal estimado: $' + formatPrice(total) + '%0A';
      texto += '%0A¿Me podrían confirmar stock, precio final y formas de pago?';

      const numero = '5491137286846';
      window.open('https://wa.me/' + numero + '?text=' + texto, '_blank');
    }

    function pagarConMercadoPago() {
      if (cart.length === 0) {
        alert('Primero agregá productos al carrito.');
        return;
      }

      let total = 0;
      cart.forEach(item => total += item.price * item.qty);

      const msg =
        'El total estimado de tu carrito es $' + formatPrice(total) +
        '.\n\nEste botón te llevará a un link de pago de Mercado Pago configurado por Segudab. ' +
        'Si el monto no coincide exactamente, se ajustará manualmente con el comercio.\n\n¿Querés continuar?';

      if (confirm(msg)) window.open(MP_LINK, '_blank');
    }

    let currentCategory = 'all';
    const filterButtons = document.querySelectorAll('.filter-btn');
    const filterPrice = document.getElementById('filter-price');
    const clearFiltersBtn = document.getElementById('clear-filters');

    function updateProductCount() {
      const label = document.getElementById('product-count-text');
      const visible = visibleProductCards.length;
      if (label) label.textContent = visible === 1 ? 'Mostrando 1 producto' : `Mostrando ${visible} productos`;
    }

    function loadCategoryFromURL() {
      const params = new URLSearchParams(window.location.search);
      const cat = params.get('cat');
      if (!cat) return;

      const btn = document.querySelector(`.filter-btn[data-category="${cat}"]`);
      if (btn) {
        filterButtons.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentCategory = cat;
      }
    }

    function applyFilters() {
      const priceFilter = filterPrice.value;
      const cards = document.querySelectorAll('.product-card');
      visibleProductCards = [];

      cards.forEach(card => {
        const cardCat = card.dataset.category;
        const priceValue = Number(card.dataset.price);
        let show = true;

        if (currentCategory === 'calzado') {
          if (!['zapatos','borcegos','botines','botas'].includes(cardCat)) show = false;
        } else if (currentCategory !== 'all' && cardCat !== currentCategory) {
          show = false;
        }

        if (priceFilter !== 'all') {
          if (priceFilter === 'low' && priceValue >= 20000) show = false;
          if (priceFilter === 'mid' && (priceValue < 20000 || priceValue > 40000)) show = false;
          if (priceFilter === 'high' && priceValue <= 40000) show = false;
        }

        if (searchTerm) {
          const nameEl = card.querySelector('.product-name');
          const descEl = card.querySelector('.product-desc');
          const text = ((nameEl ? nameEl.textContent : '') + ' ' + (descEl ? descEl.textContent : '')).toLowerCase();
          if (!text.includes(searchTerm)) show = false;
        }

        card.style.display = show ? 'block' : 'none';
        if (show) visibleProductCards.push(card);
      });

      updateProductCount();
    }

    filterButtons.forEach(btn => {
      const cat = btn.dataset.category;
      if (!cat) return;

      btn.addEventListener('click', () => {
        filterButtons.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentCategory = btn.dataset.category;
        applyFilters();
      });
    });

    filterPrice.addEventListener('change', applyFilters);

    if (clearFiltersBtn) {
      clearFiltersBtn.addEventListener('click', () => {
        currentCategory = 'all';
        const allBtn = document.querySelector('.filter-btn[data-category="all"]');
        if (allBtn) {
          filterButtons.forEach(b => b.classList.remove('active'));
          allBtn.classList.add('active');
        }
        filterPrice.value = 'all';
        const filterSearch = document.getElementById('filter-search');
        searchTerm = '';
        if (filterSearch) filterSearch.value = '';
        applyFilters();
      });
    }

    function setupProductDetailEvents() {
      const cards = document.querySelectorAll('.product-card');

      cards.forEach(card => {
        card.addEventListener('click', () => openProductDetail(card));

        const btn = card.querySelector('.btn-small');
        if (btn) {
          btn.addEventListener('click', (e) => {
            e.stopPropagation();
            openProductDetail(card);
          });
        }
      });

      const overlay = document.getElementById('product-detail-overlay');
      const closeBtn = document.getElementById('detail-close-btn');
      const addBtn = document.getElementById('detail-add-btn');
      const prevBtn = document.getElementById('detail-prev-btn');
      const nextBtn = document.getElementById('detail-next-btn');

      const gPrev = document.getElementById('gallery-prev-btn');
      const gNext = document.getElementById('gallery-next-btn');

      if (closeBtn) closeBtn.addEventListener('click', closeProductDetail);

      if (prevBtn) prevBtn.addEventListener('click', (e) => { e.stopPropagation(); showPrevProduct(); });
      if (nextBtn) nextBtn.addEventListener('click', (e) => { e.stopPropagation(); showNextProduct(); });

      if (gPrev) gPrev.addEventListener('click', (e) => { e.stopPropagation(); showPrevGallery(); });
      if (gNext) gNext.addEventListener('click', (e) => { e.stopPropagation(); showNextGallery(); });

      if (overlay) {
        overlay.addEventListener('click', (e) => {
          if (e.target === overlay) closeProductDetail();
        });
      }

      const detailImage = document.getElementById('detail-image');
      const zoomOverlay = document.getElementById('image-zoom-overlay');
      const zoomImage = document.getElementById('zoom-image');

      if (detailImage && zoomOverlay && zoomImage) {
        detailImage.addEventListener('click', () => {
          if (!currentProduct || !currentProduct.imageUrl) return;
          zoomImage.src = currentProduct.imageUrl;
          zoomOverlay.style.display = 'flex';
        });

        zoomOverlay.addEventListener('click', () => {
          zoomOverlay.style.display = 'none';
        });
      }

      document.addEventListener('keydown', (e) => {
        const overlayEl = document.getElementById('product-detail-overlay');
        const isDetailOpen = overlayEl && overlayEl.style.display === 'flex';

        if (e.key === 'Escape') {
          closeProductDetail();
          const zoomOverlayEl = document.getElementById('image-zoom-overlay');
          if (zoomOverlayEl) zoomOverlayEl.style.display = 'none';
        }

        if (isDetailOpen && e.key === 'ArrowRight') { e.preventDefault(); showNextProduct(); }
        if (isDetailOpen && e.key === 'ArrowLeft')  { e.preventDefault(); showPrevProduct(); }
      });

      if (addBtn) {
        addBtn.addEventListener('click', () => {
          if (!currentProduct) return;

          const detailSizeEl = document.getElementById('detail-size');
          const detailQtyEl  = document.getElementById('detail-qty');
          const colorEl = document.getElementById('detail-color');

          const modelOrSize = detailSizeEl ? (detailSizeEl.value || 'A coordinar') : 'A coordinar';

          const talleEl = document.getElementById('detail-talle');
          const talleWrapEl = document.getElementById('detail-talle-wrap');
          const talle = (talleWrapEl && talleWrapEl.style.display !== 'none' && talleEl && talleEl.options.length)
            ? (talleEl.value || '')
            : '';

          const color = (colorEl && colorEl.options.length) ? (colorEl.value || '') : '';

          let labelParts = [];
          if (modelOrSize) labelParts.push(modelOrSize);
          if (talle) labelParts.push(talle);
          if (color) labelParts.push(color);

          const sizeLabel = labelParts.join(' / ');

          const qty = detailQtyEl ? Math.max(1, parseInt(detailQtyEl.value || '1', 10)) : 1;

          addToCart(currentProduct.name, currentProduct.price, sizeLabel || 'A coordinar', qty);
          closeProductDetail();
        });
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      loadCart();
      renderCart();
      loadCategoryFromURL();

      const filterSearch = document.getElementById('filter-search');
      if (filterSearch) {
        filterSearch.addEventListener('input', () => {
          searchTerm = filterSearch.value.toLowerCase().trim();
          applyFilters();
        });
      }

      applyFilters();
      setupProductDetailEvents();
      updateGalleryArrows();
    });
  </script>

</body>
</html>
